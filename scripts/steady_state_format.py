import numpy as np

def print_steady_state_format (sv):
    for i in range(len(sv)):
        #print("sv[%d] = %e;" % (i,sv[i]))
        #print("extra_data[%d+offset] = %e;" % (i,sv[i]))
        print("*((real * )((char *) sv + pitch * %d) + threadID) = %e;" % (i,sv[i]))

def get_correct_indexes (sv):
    nlin = np.shape(sv)

    v       =  sv[0] 
    nai     =  sv[1] 
    nass    =  sv[2] 
    ki      =  sv[3] 
    kss     =  sv[4] 
    cai     =  sv[5] 
    cass    =  sv[6] 
    cansr   =  sv[7] 
    cajsr   =  sv[8] 
    m       =  sv[9] 
    hp      =  sv[10]
    h       =  sv[11]
    j       =  sv[12]
    jp      =  sv[13]
    mL      =  sv[14]
    hL      =  sv[15]
    hLp     =  sv[16]
    a       =  sv[17]
    iF      =  sv[18]
    iS      =  sv[19]
    ap      =  sv[20]
    iFp     =  sv[21]
    iSp     =  sv[22]
    d       =  sv[23]
    ff      =  sv[24]
    fs      =  sv[25]
    fcaf    =  sv[26]
    fcas    =  sv[27]
    jca     =  sv[28]
    nca_ss  =  sv[29]
    nca_i   =  sv[30]
    ffp     =  sv[31]
    fcafp   =  sv[32]
    xs1     =  sv[33]
    xs2     =  sv[34]
    Jrel_np =  sv[35]
    CaMKt   =  sv[36]
    C3      =  sv[37]
    C2      =  sv[38]
    C1      =  sv[39]
    O       =  sv[40]
    I       =  sv[41]
    Jrel_p  =  sv[42]

    # Change the columns to the Lucas`s mapping
    sv_new = np.zeros(nlin)

    sv_new[0]  = v        
    sv_new[1]  = CaMKt    
    sv_new[2]  = cass     
    sv_new[3]  = nai      
    sv_new[4]  = nass     
    sv_new[5]  = ki       
    sv_new[6]  = kss      
    sv_new[7]  = cansr    
    sv_new[8]  = cajsr    
    sv_new[9]  = cai      
    sv_new[10] = m        
    sv_new[11] = h        
    sv_new[12] = j        
    sv_new[13] = hp       
    sv_new[14] = jp       
    sv_new[15] = mL       
    sv_new[16] = hL       
    sv_new[17] = hLp      
    sv_new[18] = a        
    sv_new[19] = iF       
    sv_new[20] = iS       
    sv_new[21] = ap       
    sv_new[22] = iFp      
    sv_new[23] = iSp      
    sv_new[24] = d        
    sv_new[25] = ff       
    sv_new[26] = fs       
    sv_new[27] = fcaf     
    sv_new[28] = fcas     
    sv_new[29] = jca      
    sv_new[30] = ffp      
    sv_new[31] = fcafp    
    sv_new[32] = nca_ss   
    sv_new[33] = nca_i    
    sv_new[34] = C1       
    sv_new[35] = C2       
    sv_new[36] = C3       
    sv_new[37] = I        
    sv_new[38] = O        
    sv_new[39] = xs1      
    sv_new[40] = xs2      
    sv_new[41] = Jrel_np  
    sv_new[42] = Jrel_p

    return sv_new

# ToRORd_fkatp steady-state solution after 200 beats using Jakub Tomek Matlab code
#torord_baseline_endo_ss = [-8.890585e+01,1.210818e+01,1.210851e+01,1.426206e+02,1.426205e+02,7.455488e-05,6.504164e-05,1.530373e+00,1.528032e+00,7.814592e-04,6.752873e-01,8.313839e-01,8.311938e-01,8.308255e-01,1.585610e-04,5.294475e-01,2.896996e-01,9.419166e-04,9.996194e-01,5.938602e-01,4.799180e-04,9.996194e-01,6.543754e-01,-2.898677e-33,1.000000e+00,9.389659e-01,1.000000e+00,9.999003e-01,9.999773e-01,4.920606e-04,8.337021e-04,1.000000e+00,1.000000e+00,2.471690e-01,1.742987e-04,5.421027e-24,1.107642e-02,9.980807e-01,8.425453e-04,6.962775e-04,3.675442e-04,1.289824e-05,6.407933e-23]
#torord_baseline_epi_ss = [-8.917755e+01,1.284260e+01,1.284291e+01,1.429114e+02,1.429113e+02,6.631866e-05,5.767956e-05,1.812268e+00,1.810520e+00,7.370422e-04,6.840260e-01,8.366816e-01,8.366012e-01,8.363958e-01,1.505860e-04,5.412669e-01,3.043382e-01,9.248184e-04,9.996371e-01,9.996342e-01,4.712023e-04,9.996371e-01,9.996366e-01,4.333129e-43,1.000000e+00,9.485160e-01,1.000000e+00,9.999339e-01,9.999822e-01,3.086885e-04,5.303737e-04,1.000000e+00,1.000000e+00,2.308784e-01,1.690386e-04,-1.103286e-23,1.288116e-02,9.982135e-01,8.264829e-04,6.775197e-04,2.730221e-04,9.433146e-06,-6.177055e-22]
#torord_baseline_mid_ss = [-8.924177e+01,1.503347e+01,1.503401e+01,1.434407e+02,1.434406e+02,8.177438e-05,6.585066e-05,1.959747e+00,1.963459e+00,7.269124e-04,6.860578e-01,8.379059e-01,8.377164e-01,8.372100e-01,1.487602e-04,5.350003e-01,2.851164e-01,9.208259e-04,9.996411e-01,5.673539e-01,4.691672e-04,9.996412e-01,6.265825e-01,-4.922960e-40,1.000000e+00,9.200354e-01,1.000000e+00,9.997888e-01,9.999665e-01,5.161178e-04,1.189422e-03,1.000000e+00,1.000000e+00,2.650323e-01,1.678628e-04,2.091039e-25,1.922391e-02,9.979358e-01,8.225453e-04,6.917041e-04,5.316232e-04,1.835276e-05,2.438403e-23]

# ToRORd_dynCl steady-state solution after 200 beats using MonoAlg3D
torord_baseline_endo_ss = [-90.351922,0.011629,0.000065,12.398927,12.399262,148.241468,148.241417,1.527292,1.524395,0.000074,0.000572,0.857942,0.857799,0.719966,0.857576,0.000120,0.574897,0.325018,0.000854,0.999705,0.595935,0.000435,0.999705,0.658989,0.000000,1.000000,0.934371,1.000000,0.999881,0.999982,1.000000,1.000000,0.000483,0.000818,0.998334,0.000760,0.000626,0.000009,0.000272,0.256815,0.000148,0.000000,0.000000,29.782041,29.782006]
#torord_baseline_epi_ss = [-90.384463,0.013214,0.000057,12.968366,12.968675,147.789526,147.789471,1.801231,1.798984,0.000066,0.000568,0.858500,0.858437,0.720928,0.858306,0.000120,0.579344,0.334804,0.000853,0.999706,0.999705,0.000434,0.999706,0.999706,0.000000,1.000000,0.943616,1.000000,0.999921,0.999985,1.000000,1.000000,0.000302,0.000516,0.998400,0.000759,0.000620,0.000007,0.000214,0.242629,0.000148,0.000000,0.000000,30.053808,30.053777]
#torord_baseline_mid_ss = [-90.327008,0.018897,0.000064,13.341084,13.341551,147.475404,147.475337,1.814771,1.815495,0.000078,0.000575,0.857517,0.857363,0.719234,0.856975,0.000121,0.566607,0.306197,0.000856,0.999703,0.557760,0.000436,0.999703,0.615757,0.000000,1.000000,0.903839,1.000000,0.999676,0.999960,1.000000,1.000000,0.000462,0.000976,0.998074,0.000761,0.000643,0.000016,0.000505,0.302166,0.000149,0.000000,0.000000,30.262060,30.262025]

print_steady_state_format(torord_baseline_endo_ss)
print()

# Trovato steady-state solution after 200 beats using MonoAlg3D
#trovato_baseline_ss = [-86.688191,0.004962,0.000102,8.240764,8.240456,8.240464,143.758610,143.759021,143.759023,0.000044,0.000102,1.260273,1.245054,1.261940,0.000153,0.000000,0.006321,0.788783,0.788720,0.790634,0.579935,0.791110,0.000242,0.463811,0.240473,0.000273,0.649762,0.989971,0.000000,1.000000,0.926852,1.000000,1.000000,0.999979,1.000000,1.000000,0.005431,0.000304,0.994221,0.000329,0.570731,0.190958,0.000223,0.233466,0.997083,0.465571]

#torord_baseline_endo_ss = get_correct_indexes(torord_baseline_endo_ss)
#print_steady_state_format(torord_baseline_endo_ss)
#print()

#torord_baseline_epi_ss = get_correct_indexes(torord_baseline_epi_ss)
#print_steady_state_format(torord_baseline_epi_ss)
#print()

#torord_baseline_mid_ss = get_correct_indexes(torord_baseline_mid_ss)
#print_steady_state_format(torord_baseline_mid_ss)
#print()

#print_steady_state_format(trovato_baseline_ss)
#print()